# 性能优化建议

## 翻译速度慢或超时的解决方案

### 问题原因

1. **文本过长**：单页PDF文本超过2000字符
2. **模型响应慢**：某些模型处理速度较慢
3. **网络延迟**：网络连接不稳定
4. **API限流**：请求频率过高

---

## 解决方案

### 1. 选择更快的模型 ⚡

#### 推荐模型（按速度排序）

| 模型 | 速度 | 质量 | 适用场景 |
|------|------|------|----------|
| **qwen-turbo** | ⚡⚡⚡⚡⚡ | ⭐⭐⭐ | 快速翻译，大批量 |
| **qwen-plus** | ⚡⚡⚡⚡ | ⭐⭐⭐⭐ | 平衡速度和质量 |
| **qwen2.5-7b-instruct** | ⚡⚡⚡⚡ | ⭐⭐⭐ | 快速，成本低 |
| **qwen-max** | ⚡⚡⚡ | ⭐⭐⭐⭐⭐ | 高质量，较慢 |
| **qwen2.5-72b-instruct** | ⚡⚡ | ⭐⭐⭐⭐⭐ | 最高质量，最慢 |

**建议**：
- 日常使用：`qwen-turbo` 或 `qwen-plus`
- 重要文档：`qwen-max`（接受较慢速度）

### 2. 自动分块翻译 📦

应用已实现自动分块功能：
- 文本超过 **2000字符** 自动分块
- 每块独立翻译，降低超时风险
- 自动合并翻译结果

**无需手动操作**，系统会自动处理！

### 3. 减少单次翻译量 📄

如果PDF很大：
- **方案A**：只翻译部分页面
- **方案B**：分多次上传翻译
- **方案C**：提取关键页面翻译

### 4. 优化网络连接 🌐

#### 检查网络
```bash
ping dashscope.aliyuncs.com
```

#### 改善网络
- 使用稳定的网络连接
- 避免使用公共WiFi
- 如果在国外，考虑使用VPN

### 5. 调整超时设置 ⏱️

当前设置：
- 单次请求超时：**120秒**
- 自动重试：**2次**

如果仍然超时，可能需要：
- 使用更快的模型
- 减少文本长度
- 检查网络连接

---

## 性能对比

### 实际测试数据（参考）

| 场景 | 模型 | 文本长度 | 耗时 |
|------|------|---------|------|
| 简单翻译 | qwen-turbo | 500字符 | 2-3秒 |
| 一般翻译 | qwen-plus | 1000字符 | 5-8秒 |
| 长文本 | qwen-plus | 5000字符 | 20-30秒 |
| 专业翻译 | qwen-max | 1000字符 | 10-15秒 |
| 超长文本 | qwen-turbo | 10000字符 | 40-60秒（分块） |

### 影响因素

1. **文本长度**：越长越慢
2. **模型选择**：大模型更慢
3. **网络状况**：延迟影响速度
4. **API负载**：高峰期可能变慢

---

## 最佳实践

### 快速翻译策略

```
1. 选择 qwen-turbo 模型
2. 上传PDF
3. 等待自动分块翻译
4. 查看结果
```

### 高质量翻译策略

```
1. 选择 qwen-max 模型
2. 只翻译重要页面
3. 接受较长等待时间
4. 获得最佳翻译质量
```

### 大批量翻译策略

```
1. 选择 qwen-turbo 模型
2. 分多次上传（每次10-20页）
3. 利用自动分块功能
4. 逐步完成翻译
```

---

## 故障排查

### 问题：翻译一直超时

**检查清单**：
- [ ] 是否使用了慢速模型（如qwen2.5-72b）？
- [ ] 单页文本是否超过5000字符？
- [ ] 网络连接是否稳定？
- [ ] 是否在高峰时段？

**解决方案**：
1. 切换到 `qwen-turbo` 模型
2. 检查网络连接
3. 稍后重试
4. 减少翻译页数

### 问题：部分页面翻译失败

**原因**：
- 该页文本过长
- 网络临时中断
- API临时故障

**解决方案**：
- 查看浏览器控制台日志
- 重新翻译失败的页面
- 使用更快的模型

### 问题：翻译质量不佳

**原因**：
- 使用了快速模型（qwen-turbo）
- 文本格式复杂
- 专业术语较多

**解决方案**：
- 切换到 `qwen-max` 模型
- 手动调整翻译结果
- 使用专业翻译服务

---

## 性能监控

### 查看翻译日志

在PyCharm运行窗口查看：
```
[阿里云翻译] 使用模型: qwen-plus
[阿里云翻译] 文本长度: 5127 字符
[阿里云翻译] 分成 3 块进行翻译
[阿里云翻译] 翻译第 1/3 块...
[阿里云翻译] 翻译第 2/3 块...
[阿里云翻译] 翻译第 3/3 块...
[阿里云翻译] 所有块翻译完成
```

### 浏览器控制台

按 `F12` 打开开发者工具，查看：
```
开始翻译第 1 页，文本长度: 5127 字符
第 1 页翻译完成
```

---

## 成本优化

### 降低成本的方法

1. **使用 qwen-turbo**：成本最低
2. **只翻译必要页面**：减少调用次数
3. **批量翻译**：提高效率
4. **监控使用量**：设置预算提醒

### 成本估算（参考）

| 模型 | 1000字符成本 | 10页PDF成本 |
|------|-------------|------------|
| qwen-turbo | 低 | ¥0.1-0.3 |
| qwen-plus | 中 | ¥0.3-0.8 |
| qwen-max | 高 | ¥0.8-2.0 |

*实际价格以阿里云官网为准*

---

## 总结

### 推荐配置

**日常使用**：
- 模型：`qwen-plus`
- 适合：一般文档翻译
- 速度：中等
- 质量：良好

**快速翻译**：
- 模型：`qwen-turbo`
- 适合：大批量、简单文本
- 速度：最快
- 质量：可接受

**专业翻译**：
- 模型：`qwen-max`
- 适合：重要文档、学术论文
- 速度：较慢
- 质量：最佳

### 关键提示

1. ✅ 系统已自动优化长文本翻译
2. ✅ 超时会自动重试2次
3. ✅ 选择合适的模型很重要
4. ✅ 网络稳定性影响速度
5. ✅ 可以随时切换模型

祝你翻译顺利！🚀

